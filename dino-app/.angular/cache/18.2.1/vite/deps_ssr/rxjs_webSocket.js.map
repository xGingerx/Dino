{
  "version": 3,
  "sources": ["../../../../../node_modules/rxjs/dist/cjs/internal/observable/dom/WebSocketSubject.js", "../../../../../node_modules/rxjs/dist/cjs/internal/observable/dom/webSocket.js", "../../../../../node_modules/rxjs/dist/cjs/webSocket/index.js"],
  "sourcesContent": ["\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WebSocketSubject = void 0;\nvar Subject_1 = require(\"../../Subject\");\nvar Subscriber_1 = require(\"../../Subscriber\");\nvar Observable_1 = require(\"../../Observable\");\nvar Subscription_1 = require(\"../../Subscription\");\nvar ReplaySubject_1 = require(\"../../ReplaySubject\");\nvar DEFAULT_WEBSOCKET_CONFIG = {\n  url: '',\n  deserializer: function (e) {\n    return JSON.parse(e.data);\n  },\n  serializer: function (value) {\n    return JSON.stringify(value);\n  }\n};\nvar WEBSOCKETSUBJECT_INVALID_ERROR_OBJECT = 'WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }';\nvar WebSocketSubject = function (_super) {\n  __extends(WebSocketSubject, _super);\n  function WebSocketSubject(urlConfigOrSource, destination) {\n    var _this = _super.call(this) || this;\n    _this._socket = null;\n    if (urlConfigOrSource instanceof Observable_1.Observable) {\n      _this.destination = destination;\n      _this.source = urlConfigOrSource;\n    } else {\n      var config = _this._config = __assign({}, DEFAULT_WEBSOCKET_CONFIG);\n      _this._output = new Subject_1.Subject();\n      if (typeof urlConfigOrSource === 'string') {\n        config.url = urlConfigOrSource;\n      } else {\n        for (var key in urlConfigOrSource) {\n          if (urlConfigOrSource.hasOwnProperty(key)) {\n            config[key] = urlConfigOrSource[key];\n          }\n        }\n      }\n      if (!config.WebSocketCtor && WebSocket) {\n        config.WebSocketCtor = WebSocket;\n      } else if (!config.WebSocketCtor) {\n        throw new Error('no WebSocket constructor can be found');\n      }\n      _this.destination = new ReplaySubject_1.ReplaySubject();\n    }\n    return _this;\n  }\n  WebSocketSubject.prototype.lift = function (operator) {\n    var sock = new WebSocketSubject(this._config, this.destination);\n    sock.operator = operator;\n    sock.source = this;\n    return sock;\n  };\n  WebSocketSubject.prototype._resetState = function () {\n    this._socket = null;\n    if (!this.source) {\n      this.destination = new ReplaySubject_1.ReplaySubject();\n    }\n    this._output = new Subject_1.Subject();\n  };\n  WebSocketSubject.prototype.multiplex = function (subMsg, unsubMsg, messageFilter) {\n    var self = this;\n    return new Observable_1.Observable(function (observer) {\n      try {\n        self.next(subMsg());\n      } catch (err) {\n        observer.error(err);\n      }\n      var subscription = self.subscribe({\n        next: function (x) {\n          try {\n            if (messageFilter(x)) {\n              observer.next(x);\n            }\n          } catch (err) {\n            observer.error(err);\n          }\n        },\n        error: function (err) {\n          return observer.error(err);\n        },\n        complete: function () {\n          return observer.complete();\n        }\n      });\n      return function () {\n        try {\n          self.next(unsubMsg());\n        } catch (err) {\n          observer.error(err);\n        }\n        subscription.unsubscribe();\n      };\n    });\n  };\n  WebSocketSubject.prototype._connectSocket = function () {\n    var _this = this;\n    var _a = this._config,\n      WebSocketCtor = _a.WebSocketCtor,\n      protocol = _a.protocol,\n      url = _a.url,\n      binaryType = _a.binaryType;\n    var observer = this._output;\n    var socket = null;\n    try {\n      socket = protocol ? new WebSocketCtor(url, protocol) : new WebSocketCtor(url);\n      this._socket = socket;\n      if (binaryType) {\n        this._socket.binaryType = binaryType;\n      }\n    } catch (e) {\n      observer.error(e);\n      return;\n    }\n    var subscription = new Subscription_1.Subscription(function () {\n      _this._socket = null;\n      if (socket && socket.readyState === 1) {\n        socket.close();\n      }\n    });\n    socket.onopen = function (evt) {\n      var _socket = _this._socket;\n      if (!_socket) {\n        socket.close();\n        _this._resetState();\n        return;\n      }\n      var openObserver = _this._config.openObserver;\n      if (openObserver) {\n        openObserver.next(evt);\n      }\n      var queue = _this.destination;\n      _this.destination = Subscriber_1.Subscriber.create(function (x) {\n        if (socket.readyState === 1) {\n          try {\n            var serializer = _this._config.serializer;\n            socket.send(serializer(x));\n          } catch (e) {\n            _this.destination.error(e);\n          }\n        }\n      }, function (err) {\n        var closingObserver = _this._config.closingObserver;\n        if (closingObserver) {\n          closingObserver.next(undefined);\n        }\n        if (err && err.code) {\n          socket.close(err.code, err.reason);\n        } else {\n          observer.error(new TypeError(WEBSOCKETSUBJECT_INVALID_ERROR_OBJECT));\n        }\n        _this._resetState();\n      }, function () {\n        var closingObserver = _this._config.closingObserver;\n        if (closingObserver) {\n          closingObserver.next(undefined);\n        }\n        socket.close();\n        _this._resetState();\n      });\n      if (queue && queue instanceof ReplaySubject_1.ReplaySubject) {\n        subscription.add(queue.subscribe(_this.destination));\n      }\n    };\n    socket.onerror = function (e) {\n      _this._resetState();\n      observer.error(e);\n    };\n    socket.onclose = function (e) {\n      if (socket === _this._socket) {\n        _this._resetState();\n      }\n      var closeObserver = _this._config.closeObserver;\n      if (closeObserver) {\n        closeObserver.next(e);\n      }\n      if (e.wasClean) {\n        observer.complete();\n      } else {\n        observer.error(e);\n      }\n    };\n    socket.onmessage = function (e) {\n      try {\n        var deserializer = _this._config.deserializer;\n        observer.next(deserializer(e));\n      } catch (err) {\n        observer.error(err);\n      }\n    };\n  };\n  WebSocketSubject.prototype._subscribe = function (subscriber) {\n    var _this = this;\n    var source = this.source;\n    if (source) {\n      return source.subscribe(subscriber);\n    }\n    if (!this._socket) {\n      this._connectSocket();\n    }\n    this._output.subscribe(subscriber);\n    subscriber.add(function () {\n      var _socket = _this._socket;\n      if (_this._output.observers.length === 0) {\n        if (_socket && (_socket.readyState === 1 || _socket.readyState === 0)) {\n          _socket.close();\n        }\n        _this._resetState();\n      }\n    });\n    return subscriber;\n  };\n  WebSocketSubject.prototype.unsubscribe = function () {\n    var _socket = this._socket;\n    if (_socket && (_socket.readyState === 1 || _socket.readyState === 0)) {\n      _socket.close();\n    }\n    this._resetState();\n    _super.prototype.unsubscribe.call(this);\n  };\n  return WebSocketSubject;\n}(Subject_1.AnonymousSubject);\nexports.WebSocketSubject = WebSocketSubject;\n", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.webSocket = void 0;\nvar WebSocketSubject_1 = require(\"./WebSocketSubject\");\nfunction webSocket(urlConfigOrSource) {\n  return new WebSocketSubject_1.WebSocketSubject(urlConfigOrSource);\n}\nexports.webSocket = webSocket;\n", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WebSocketSubject = exports.webSocket = void 0;\nvar webSocket_1 = require(\"../internal/observable/dom/webSocket\");\nObject.defineProperty(exports, \"webSocket\", {\n  enumerable: true,\n  get: function () {\n    return webSocket_1.webSocket;\n  }\n});\nvar WebSocketSubject_1 = require(\"../internal/observable/dom/WebSocketSubject\");\nObject.defineProperty(exports, \"WebSocketSubject\", {\n  enumerable: true,\n  get: function () {\n    return WebSocketSubject_1.WebSocketSubject;\n  }\n});\n"],
  "mappings": "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",
  "names": ["d", "b", "WebSocketSubject", "require_webSocket"]
}
